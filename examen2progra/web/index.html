<!DOCTYPE html>
<html>
    <head>
        <title>Login </title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" type="image/x-icon" href="/examen_2/img/logo.png" />
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"  crossorigin="anonymous">

    </head>

    <body  style="background-image: url(img/background.jpg); background-repeat: no-repeat; background-size: 100%;">

        <div id="page-wrapper">
            <div class="container">

                <div class="row">
                    <div class="col-sm-4 mx-auto my-5">
                        <div class="row">
                            <div class="col-12 d-flex justify-content-center text-center  my-4">
                                <img src="img/arrobaIcon2.png" height="80" />
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="input-group">
                                <span class="input-group-addon">
                                    <span class="input-group-text" style="padding-bottom: 10px; padding-top: 13px;"></span>
                                </span>
                                <input type="text" name="email" id="input-user" class="form-control input-lg" placeholder="Email Address" autofocus="" required>

                            </div>

                            <div class="input-group">
                                <span class="input-group-addon">
                                    <span class="input-group-text" style="padding-bottom: 10px; padding-top: 13px;"></span>
                                </span>
                                <input type="password" name="password" id="input-password" class="form-control input-lg" placeholder="New Password"  required>
                            </div>

                            <div class="row d-flex justify-content-center">
                                <div class="col-12 my-3">
                                    <button type="submit" class="btn btn-block btn-lg" id='sendLogin' style="background-color: #43d0bf; color: white;">Sign in</button>
                                </div>
                            </div>
                            <div id="incorrect" class="alert alert-danger" role="alert" >
                                <strong>Incorrect</strong> usarname or Password!
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <!--JQUERY-->
        <script src="https://code.jquery.com/jquery-3.5.1.js"  crossorigin="anonymous"></script>

        <!--BOOTSTRAP-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js"  crossorigin="anonymous"></script>       
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" crossorigin="anonymous"></script>
        <!--iconos de font awesome-->
        <script src="https://kit.fontawesome.com/39f4ebbbea.js" crossorigin="anonymous"></script>

        <script>
            function loaded(event) {
                $("#incorrect").hide();
                events();
            }
            function events() {
                ingresar();
            }
            function ingresar(status) {
                $("#sendLogin").click(function () {
                    var email = $("#input-user").val();
                    var clave = $("#input-password").val();
                    console.log(clave);
                    if (clave.length <= 0 || email.length <= 0) {
                        $("#input-user").addClass("error");
                        $("#input-password").addClass("error");
                        $("#incorrect").fadeTo(2000, 300).slideUp(200, function () {
                            $("#incorrect").slideUp(200);
                        });
                    } else {
                        var usuario = {
                            email: email,
                            contrasena: clave,
                            rol: -1
                        };
                        $.ajax({
                            type: "POST",
                            url: "api/login",
                            data: JSON.stringify(usuario),
                            contentType: "application/json"
                        }).then((usuario) => {
                            location.href = "/examen_2/client/indexClient.html";
                        }, (error) => {
                            $("#input-user").addClass("error");
                            $("#input-password").addClass("error");
                            $("#incorrect").fadeTo(2000, 500).slideUp(500, function () {
                                $("#incorrect").slideUp(500);
                            });
                        });
                    }
                });

            }
            document.addEventListener("DOMContentLoaded", loaded);
        </script>
    </body>
</html>
